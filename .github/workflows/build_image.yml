name: TICS image CI

on:
   push

jobs:
   build_and_publish: 
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v4

        - name: Log in to GitHub Container Registry (GHCR)
          uses: docker/login-action@v3
          with:
             registry: ghcr.io
             username: ${{ github.actor }}
             password: ${{ secrets.PKGTOKEN }}
        
        - name: Set up Docker Buildx
          uses: docker/setup-buildx-action@v3
           
        - name: Build and push the app image
          uses: docker/build-push-action@v6
          with:
             context: .
             push: true
             image: ticsimg
             tags: latest
             secrets: |
                      "env=${{ secrets.TICSAUTHTOKEN }}"
